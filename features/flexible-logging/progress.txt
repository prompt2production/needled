---
Story: FLEX-001 Add updatedAt fields to database schema
Completed: 2026-01-24T06:18:00Z
Files changed: prisma/schema.prisma, prisma/migrations/20260124000001_add_updatedat_fields/migration.sql
Notes: Added updatedAt DateTime @updatedAt to WeighIn and Injection models. Migration deployed successfully. Prisma client types already had the fields.
---
---
Story: FLEX-002 Create date validation schema
Completed: 2026-01-24T06:20:00Z
Files changed: src/lib/validations/log-date.ts, tests/unit/validations/log-date.test.ts
Notes: Created logDateSchema that validates dates in YYYY-MM-DD format, rejects future dates and dates more than 90 days in the past.
---
---
Story: FLEX-003 Update weigh-in POST to accept date parameter
Completed: 2026-01-24T06:23:00Z
Files changed: src/lib/validations/weigh-in.ts, src/app/api/weigh-ins/route.ts, tests/unit/validations/weigh-in.test.ts, tests/unit/api/weigh-ins.test.ts
Notes: Added optional date field to weigh-in schema using logDateSchema. Removed same-week restriction (409 conflict). Multiple weigh-ins per week now allowed.
---
---
Story: FLEX-004 Add hasWeighedThisWeek to weigh-in latest API
Completed: 2026-01-24T06:25:00Z
Files changed: src/app/api/weigh-ins/latest/route.ts, tests/unit/api/weigh-ins-latest.test.ts
Notes: Added hasWeighedThisWeek boolean to response. canWeighIn is now always true. hasWeighedThisWeek indicates whether user has logged a weigh-in in current week.
---
---
Story: FLEX-005 Create PATCH endpoint for weigh-ins
Completed: 2026-01-24T06:27:00Z
Files changed: src/app/api/weigh-ins/[id]/route.ts, src/lib/validations/weigh-in.ts, tests/unit/api/weigh-ins-id.test.ts
Notes: Created PATCH endpoint with ownership validation. Added updateWeighInSchema. Returns 404 for not found or wrong user, 400 for invalid data, 200 with updated entry on success.
---
---
Story: FLEX-006 Create DELETE endpoint for weigh-ins
Completed: 2026-01-24T06:27:00Z
Files changed: src/app/api/weigh-ins/[id]/route.ts, tests/unit/api/weigh-ins-id.test.ts
Notes: Created DELETE endpoint with ownership validation. Returns 404 for not found or wrong user, 204 No Content on successful deletion.
---
---
Story: FLEX-007 Add date picker to weigh-in dialog
Completed: 2026-01-24T06:30:00Z
Files changed: src/components/weigh-in/WeighInInput.tsx, src/components/weigh-in/WeighInCard.tsx, src/components/weigh-in/WeighInCardConnected.tsx, src/components/ui/calendar.tsx, src/components/ui/popover.tsx
Notes: Added shadcn Calendar and Popover components. Added date picker above weight input, defaults to today, disables future dates and dates older than 90 days. Form now submits date alongside weight.
---
---
Story: FLEX-008 Show encouragement message for multiple weigh-ins
Completed: 2026-01-24T06:30:00Z
Files changed: src/components/weigh-in/WeighInInput.tsx, src/components/weigh-in/WeighInCardConnected.tsx
Notes: Added hasWeighedThisWeek prop to WeighInInput. When true, displays muted info message about multiple entries being fine but weekly tracking working best.
---
---
Story: FLEX-009 Add edit functionality to weigh-in history
Completed: 2026-01-24T06:33:00Z
Files changed: src/components/weigh-in/WeighInHistoryItem.tsx, src/components/weigh-in/WeighInEditDialog.tsx, src/components/weigh-in/index.ts, src/app/weigh-in/page.tsx
Notes: Created WeighInHistoryItem component with edit button. WeighInEditDialog pre-fills with existing values. Calls PATCH endpoint, shows toast on success/error.
---
---
Story: FLEX-010 Add delete functionality to weigh-in history
Completed: 2026-01-24T06:33:00Z
Files changed: src/components/weigh-in/WeighInHistoryItem.tsx
Notes: Added delete button with AlertDialog confirmation showing date and weight. Calls DELETE endpoint, shows toast on success, refreshes list.
---
---
Story: FLEX-011 Update injection POST to accept date parameter
Completed: 2026-01-24T06:45:00Z
Files changed: src/lib/validations/injection.ts, src/app/api/injections/route.ts, tests/unit/validations/injection.test.ts, tests/unit/api/injections.test.ts
Notes: Added optional date field to injection schema using logDateSchema. Removed same-week restriction (409 conflict). Multiple injections per week now allowed. Tests updated to verify date acceptance and removal of week restriction.
---
---
Story: FLEX-012 Create PATCH endpoint for injections
Completed: 2026-01-24T06:50:00Z
Files changed: src/app/api/injections/[id]/route.ts, tests/unit/api/injections-id.test.ts
Notes: Created PATCH endpoint for injections with ownership validation. Accepts date, site, and notes. Returns 404 for not found or wrong user, 400 for invalid data, 200 with updated entry on success.
---
---
Story: FLEX-013 Create DELETE endpoint for injections
Completed: 2026-01-24T06:55:00Z
Files changed: src/app/api/injections/[id]/route.ts, tests/unit/api/injections-id.test.ts
Notes: Added DELETE handler to injection [id] route. Returns 400 if userId not provided, 404 if not found or wrong user, 204 on successful deletion.
---
---
Story: FLEX-014 Add date picker to injection dialog
Completed: 2026-01-24T07:00:00Z
Files changed: src/components/injection/InjectionDialog.tsx, src/components/injection/InjectionCard.tsx, src/components/injection/InjectionCardConnected.tsx
Notes: Added date picker to InjectionDialog above site selection. Uses Calendar and Popover components. Defaults to today, disables future dates and dates older than 90 days. Date is included in form submission.
---
---
Story: FLEX-015 Add edit functionality to injection history
Completed: 2026-01-24T07:05:00Z
Files changed: src/components/injection/InjectionEditDialog.tsx, src/components/injection/InjectionHistory.tsx
Notes: Created InjectionEditDialog with date picker, site selector, and notes input. Pre-fills with existing values. Added edit button to InjectionHistory items (visible on hover). Calls PATCH endpoint and shows toast on success.
---
---
Story: FLEX-016 Add delete functionality to injection history
Completed: 2026-01-24T07:10:00Z
Files changed: src/components/injection/InjectionHistory.tsx
Notes: Added delete button with AlertDialog confirmation showing date and site. Calls DELETE /api/injections/[id] endpoint. Shows toast on success, refreshes list. Cancel closes dialog without action.
---
